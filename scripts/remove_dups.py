import boto3
from boto3.dynamodb.conditions import Key
import pdb

cases = [
    'MP7358',
    'MP2413',
    'MP5600',
    'MP9406',
    'MP9567',
    'MP9733',
    'MP6410',
    'MP10482',
    'MP10877',
    'MP10154',
    'MP1999',
    'MP654',
    'MP1253',
    'MP6193',
    'MP5478',
    'MP1796',
    'MP9498',
    'MP2282',
    'MP8636',
    'MP10584',
    'MP10725',
    'MP8675',
    'MP2967',
    'MP6388',
    'MP9518',
    'MP4925',
    'MP6381',
    'MP9683',
    'MP9380',
    'MP8033',
    'MP8038',
    'MP8721',
    'MP10909',
    'MP10714',
    'MP6561',
    'MP11050',
    'MP10034',
    'MP5755',
    'MP8304',
    'MP770',
    'MP8220',
    'MP8543',
    'MP7350',
    'MP9527',
    'MP3128',
    'MP9483',
    'MP9129',
    'MP9862',
    'MP10056',
    'MP8754',
    'MP2562',
    'MP3951',
    'MP582',
    'MP9555',
    'MP8771',
    'MP11063',
    'MP1487',
    'MP6747',
    'MP8594',
    'MP7644',
    'MP10256',
    'MP7222',
    'MP7618',
    'MP9722',
    'MP10602',
    'MP9014',
    'MP10218',
    'MP9371',
    'MP10032',
    'MP1209',
    'MP3258',
    'MP9873',
    'MP10501',
    'MP8188',
    'MP9370',
    'MP10892',
    'MP940',
    'MP8744',
    'MP10847',
    'MP6284',
    'MP8064',
    'MP10112',
    'MP9944',
    'MP11055',
    'MP9711',
    'MP9383',
    'MP10804',
    'MP918',
    'MP9201',
    'MP8504',
    'MP10760',
    'MP9738',
    'MP9847',
    'MP10663',
    'MP8746',
    'MP10653',
    'MP2705',
    'MP4924',
    'MP10529',
    'MP10347',
    'MP49',
    'MP720',
    'MP3279',
    'MP9298',
    'MP983',
    'MP10133',
    'MP9317',
    'MP4224',
    'MP6267',
    'MP10512',
    'MP11007',
    'MP8618',
    'MP8988',
    'MP8890',
    'MP8640',
    'MP6793',
    'MP10021',
    'MP9720',
    'MP9340',
    'MP9041',
    'MP10227',
    'MP8172',
    'MP4519',
    'MP6706',
    'MP11016',
    'MP8590',
    'MP10579',
    'MP10115',
    'MP9378',
    'MP8175',
    'MP9561',
    'MP7926',
    'MP9258',
    'MP9870',
    'MP1002',
    'MP989',
    'MP7821',
    'MP9650',
    'MP9271',
    'MP10113',
    'MP8699',
    'MP10346',
    'MP2426',
    'MP10335',
    'MP4024',
    'MP10500',
    'MP4104',
    'MP10268',
    'MP2351',
    'MP10033',
    'MP9018',
    'MP6195',
    'MP2912',
    'MP7913',
    'MP9272',
    'MP5282',
    'MP976',
    'MP10068',
    'MP9543',
    'MP6906',
    'MP7908',
    'MP3935',
    'MP10497',
    'MP8455',
    'MP6612',
    'MP9015',
    'MP10947',
    'MP893',
    'MP9580',
    'MP11021',
    'MP7827',
    'MP8096',
    'MP10581',
    'MP10642',
    'MP8341',
    'MP7134',
    'MP9269',
    'MP10206',
    'MP9552',
    'MP10295',
    'MP8491',
    'MP6877',
    'MP7027',
    'MP6630',
    'MP10005',
    'MP9837',
    'MP9347',
    'MP2791',
    'MP7646',
    'MP9375',
    'MP7676',
    'MP6614',
    'MP943',
    'MP1626',
    'MP9768',
    'MP9734',
    'MP4036',
    'MP10505',
    'MP9331',
    'MP10031',
    'MP327',
]

dynamodb = boto3.resource('dynamodb', region_name='us-east-1')
table = dynamodb.Table('People-o5msg6ojb5ahrlj5gj2g2aphsi-dev')

for case in cases:
    
    resp = table.query(
        # Add the name of the index you want to use in your query.
        IndexName="caseNumber-index",
        KeyConditionExpression=Key('caseNumber').eq(case),
    )
    if len(resp['Items']) > 1:
        idx = resp['Items'][0]['id']
        print('number of items for {0}: {1}'.format(case, len(resp['Items'])))
        table.delete_item(Key={'id': idx})
